<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Paul Northrop" />

<meta name="date" content="2023-12-02" />

<title>Overview of the itp package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Overview of the itp package</h1>
<h4 class="author">Paul Northrop</h4>
<h4 class="date">2023-12-02</h4>


<div id="TOC">
<ul>
<li><a href="#supplying-to-itp-an-r-function" id="toc-supplying-to-itp-an-r-function">Supplying to <code>itp</code> an
R function</a></li>
<li><a href="#supplying-to-itp-an-external-pointer-to-a-c-function" id="toc-supplying-to-itp-an-external-pointer-to-a-c-function">Supplying
to <code>itp</code> an external pointer to a C++ function</a></li>
<li><a href="#c-function-itp_c" id="toc-c-function-itp_c">C++ function
<code>itp_c</code></a></li>
<li><a href="#plot-method" id="toc-plot-method">Plot method</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p>The Interpolate, Truncate, Project (ITP) root-finding algorithm was
developed in <span class="citation">Oliveira and Takahashi
(2020)</span>. It’s performance compares favourably with existing
methods on both well-behaved functions and ill-behaved functions while
retaining the worst-case reliability of the bisection method. For
details see the authors’ <a href="https://www.growkudos.com/publications/10.1145%25252F3423597/reader">Kudos
summary</a> and the Wikipedia article <a href="https://en.wikipedia.org/wiki/ITP_method">ITP method</a>.</p>
<p>The <code>itp</code> function implements the ITP method to find a
root <span class="math inline">\(x^*\)</span> of the function <span class="math inline">\(f: \mathbb{R} \rightarrow \mathbb{R}\)</span> in
the interval <span class="math inline">\([a, b]\)</span>, where <span class="math inline">\(f(a)f(b) &lt; 0\)</span>. If <span class="math inline">\(f\)</span> is continuous over <span class="math inline">\([a, b]\)</span> then <span class="math inline">\(f(x^*) = 0\)</span>. If <span class="math inline">\(f\)</span> is discontinuous over <span class="math inline">\([a, b]\)</span> then <span class="math inline">\(x^*\)</span> may be an estimate of a point of
discontinuity at which the sign of <span class="math inline">\(f\)</span> changes, that is, <span class="math inline">\(f(x^* - \delta)f(x^* + \delta) \leq 0\)</span>,
where <span class="math inline">\(0 \leq \delta \leq \epsilon\)</span>
for some tolerance value <span class="math inline">\(\epsilon\)</span>.</p>
<p>We use some of the examples presented in Table 1 of <span class="citation">Oliveira and Takahashi (2020)</span> to illustrate the
use of this function and run the examples using the <code>uniroot</code>
function in the <code>stats</code> package as a means of comparison,
using a convergence tolerance of <span class="math inline">\(10^{-10}\)</span> in both cases. The
<code>itp</code> function uses the following default values of the
tuning parameters: <span class="math inline">\(\kappa_1 = 0.2 / (b -
a)\)</span>, <span class="math inline">\(\kappa_2 = 2\)</span> and <span class="math inline">\(n_0 = 1\)</span>, but these may be changed by the
user. See Sections 2 and 3 of <span class="citation">Oliveira and
Takahashi (2020)</span> for information. The following function prints
output from <code>uniroot</code> in the same style as the output from
<code>itp</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Method to print part of uniroot output</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>print.list <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">digits =</span> <span class="fu">max</span>(3L, <span class="fu">getOption</span>(<span class="st">&quot;digits&quot;</span>) <span class="sc">-</span> 3L)) {</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">names</span>(x)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;root&quot;</span>, <span class="st">&quot;f(root)&quot;</span>, <span class="st">&quot;iterations&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="fu">print.default</span>(<span class="fu">format</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">digits =</span> digits), <span class="at">print.gap =</span> 2L, <span class="at">quote =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(itp)</span></code></pre></div>
<p>First, we consider supplying the argument <code>f</code> to
<code>itp</code> using an R function. Then we show how to supply an
external pointer to a C++ function. For the simple examples given in the
<code>itp</code> package only a modest improvement in speed is observed
(and expected). However, being able to call <code>itp()</code> on the
C++ side may have benefits in more challenging problems.</p>
<div id="supplying-to-itp-an-r-function" class="section level2">
<h2>Supplying to <code>itp</code> an R function</h2>
<div id="well-behaved-functions" class="section level3">
<h3>Well-behaved functions</h3>
<p>These functions are infinitely differentiable and contain only one
simple root over <span class="math inline">\([−1, 1]\)</span>.</p>
<div id="lambert-fx-x-ex---1" class="section level4">
<h4>Lambert: <span class="math inline">\(f(x) = x e^x - 1\)</span></h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Lambert</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>lambert <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x <span class="sc">*</span> <span class="fu">exp</span>(x) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">itp</span>(lambert, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; function: lambert </span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;     0.5671   2.048e-12           8</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">uniroot</span>(lambert, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">tol =</span> <span class="fl">1e-10</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;     0.5671  -8.623e-12           8</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="trigonometric-1-fx-tanx---1-10" class="section level4">
<h4>Trigonometric 1: <span class="math inline">\(f(x) = \tan(x - 1 /
10)\)</span></h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Trigonometric 1</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>trig1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">tan</span>(x <span class="sc">-</span> <span class="dv">1</span> <span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">itp</span>(trig1, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; function: trig1 </span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;        0.1  -8.238e-14           8</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">uniroot</span>(trig1, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">tol =</span> <span class="fl">1e-10</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;        0.1   6.212e-14           8</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="ill-behaved-functions" class="section level3">
<h3>Ill-behaved functions</h3>
<div id="polynomial-3-non-simple-root-fx-106-x---1-3" class="section level4">
<h4>Polynomial 3 (non-simple root): <span class="math inline">\(f(x) =
(10^6 x - 1) ^ 3\)</span></h4>
<p>This function has a non-simple root at <span class="math inline">\(10^{-6}\)</span>, with a multiplicity of 3.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Polynomial 3</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>poly3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x <span class="sc">*</span> <span class="fl">1e6</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">^</span> <span class="dv">3</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">itp</span>(poly3, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; function: poly3 </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;      1e-06   -1.25e-13          36</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co"># Using n0 = 0 leads to (slightly) fewer iterations, in this example</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>poly3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x <span class="sc">*</span> <span class="fl">1e6</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">^</span> <span class="dv">3</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="fu">itp</span>(poly3, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">n0 =</span> <span class="dv">0</span>)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt; function: poly3 </span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt;      1e-06  -6.739e-14          35</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="fu">uniroot</span>(poly3, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">tol =</span> <span class="fl">1e-10</span>)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt;      1e-06   1.771e-17          65</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEgCAMAAABb4lATAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmZmZmkLZmkNtmtttmtv+QOgCQOmaQZjqQkLaQttuQ29uQ2/+2ZgC2Zjq2kGa22/+2/7a2///bkDrbkGbbtmbbtpDb27bb2//b/9vb////tmb/25D/27b//7b//9v///+nkR/UAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM5UlEQVR4nO2da2PbthWG4S6e3aXbOqtbdkm1bjXXbFyT1bQl//9fNoIgJVESLsSFOOf4fT7YiaIAR+cRCBAkQPUKRKNqBwDKAsHCgWDhyBPcKsNvP81f32/V7VNMgef/8fTvLz8odfPXqGJXYongRqm7/tMp9X2xcDIwCVY3j7PXSwjebYaa7mJjXYEFgtv+YzX6w+w2D+UCSuYg+MxntOBzTgrq6/qofxD+xocL3m97rd3QLNo8mSpDq776T//rZWOa8OcPSv1KH0S1l1+2prV12kmrbn78l1LvTEM/vK9vlXef36ubj6//vR/+cRT6+U/6uP94Knj/0zf9n57vZQjebfqP0Q3JMz+JMgrW/h4P7bn3MHgZ/7HRv9rTQ/nxfeNhV6n3+kf/PiO0O7z57FCwb847A1KIbcFfNvp337r6WHt7D8aLaW26kQ5O330y/3b6Pi344fVnNR59x//Y//j10FgfzgR3h2MATWL64EE1WWZ9cHNssZOnu/EIPfadvbO719P39YJNO749F/rlp/d6QDUXrKv7ttJHDUH2KHpyoQ/X5s9D+26GV80xfGjNp+8zzdv8PBG8/0GNI+bz0dpn/SayiD0Pvvn9p0mTabLGiz5G968+vM4En77vumD9xX73jy+bK4Kn5k8TiYKP6b5swfoY3U7jqgUtePjT/M0HIHhVTgVf9MGDw/dHm5PJeR98RXA3dding6yXD/cPw/8iPOgULvh8FD28okyfeSp4Poq+3oJvn1628z64/1NfxM9KRh98OD80Z4dkmQk+Pw8epMxOlMfud3YebOmDLwdZw7flfMqMFgta8H5L2euBuWAzQ/W312N/3E1zxzPBx/c5RtHv/tkej/UDLx8kXWzYbynPqofSET/Ny8yiPrjzpEaBuqQK9kF/xDYMJAgPidKAYC345g+1gygGBAsnh2DnlULugiXGD8EnSIwfgk+QGP+izzRdqDm7wO0cpnOCX/zK8Tf7ay7QgimhnH+1vuZCtGB2QLBszvON82BhQPBCmMV/EW4GwcPNho1tMpdZgi7gFf9ltOmCu5vH9vbJunSFV4IuYRX/lWCTBesbovXd0a1lpMUqQVdgFX8JwXr1ihZsG0qzStAVOMUfKjOqBTeWm5A4JYg5V1Odqw9ubTd2QPBaXM90nlH05Vx0bGEgFkuicR7sgU38EBwHl/htcUKwBybxW8OEYA884rdHmSY4YOkKjwTZYRG/I8jEFuxfusIiQdwpJ9i/dAWCy+PKcXIf7F26sqQwEIMzxRhkeaAfvztCCPZAP34IToJ8/J4AIdgD9fh98UGwB+Lxe8ODYNb4swvBrIFg2QQkF4I9UI4/JDYI9kA4/qDQINgD3fjDIoNgD2TjDwwMgj1QjT80LgjmSXBaIZgnECyb8KxCsAeS8S8ICoI9UIx/SUwQ7IFg/ItCgmAP9OJfFhEEeyAX/8KAIJgZS/MJwbxYnM5SgsXsVUmL5dlEC/ZAKv6IYCDYA6X4Y2KBYA+E4o8KBYI9kIk/cjQDwR6oxB8bBwTzIDqNEMyC+CxCMAcSkgjBHijEnxIDBHuoH3/aZCAEe6gef2IAEOyhdvyp9UOwh7rxp1+rgWDKZEgeBNMly6VWCCZLnsxBsIdq8Weq2CW4G+/JcG9lF1EBJyrFn+1OGKvg3UaNu1Dut7adZGMr4ESV+DPe6GQTvPvjqdP535Ir4ESF+LPex4Y+2MP68eet0SF4/79SFQAHmRPmELzbmE54//f4HhiCl5I7X+5RtH4aUuscYvUjMNeG/hC8iAK3kTv7YGPP9uBYTTv9a2d7G3fB68VfZpGAe5ClDbvOgvWDC0daoc8uXCv+UktAnIIbpT5ulcWcRj96dARPH6VZjXOQNRx2O0cfjBacqZJytbgE/9koc42iDw8dRR+cUEXJOlInOqZHY1mP49wFF6fw+ktMVdal+PJaXGyoyBqrp1MvF4qf6Cg4/Fln/Bb4mgVMdESXW/H8K7xqnCbFlbnizhYewf1RWs9H28BER0SB625bYhfcKPXw/LunU4kXoAUvLGz9TWmsgpteWDO0Xps6jfyJjmxU2nHIeh6s2+3z11qw7eA7gImOIOptJ2UXrFvkcFOHqwXHVfC2qLtZmPUQ3U7t1qjOWgEnEuInsROcfZDVmuGz7wnfr55j+FsUTMLsSI67KiF4eCPN3Rsh2IMtfnXOqlGF477gf+cvoDUf73w65OLDk/ydSu34Q367pGt5ASMsXi14pkc+vkN0iGMegt+U1iP+Plgrdl8PJi74bYqd8F9s6E+T9tv4uY7ap4GpZrl/MVyC9TSkMetso8srWINc7Vaw4N3GdaXwSP89uH1qbB11lQn2jEdkwYID6W4e29sn64Tm6gnK3N2+ecH6krC+HNGSuOCffzAlVfB0GVD5xtD6uqIWTOGOjjc7VHaQrQU3te/oeLtnQk5y9cGt7aLTOlmHXRtOwc/3yn3T3cBwNLe+a4XEF7XL/YvjEmzus7K2zfgKslJhbQ8nHIKnWyZJ37JTZW0PJ5wTHabpOqexqi5dWaPnFSw4pAXXXLpSb20PJ9L64Jo3vnPP/EqkjaLrLV3BaVEgaefBtVow9AaTONFRZenKqnq5f5WcgocpDPdJUoWlKytfvli1tvw4B1lm7VnYVeElFSSVt3LGBQveb83h13YZIb6ChNLWv7y8doWZcU10fGeabsL9OpYKosuqkG3BgqcWTGaqknuuq+Ce6NCGqVxswKlRFM656MCbOhZXULOct0b6Bf+ICuoVw6jiTPAQXPHwDMERFdQog2PdOWAguO7oCoIjKli3ANbVJ0NeMPcE14a6YPhNhLhg+E2FtmACfgmEkARlwSQmJynEkAJhwTRSSyOKeOgKJpJZImFEQ1YwlcRSiSMWqoK555UMRAXDby5ICiYxfBZCKcEpGwaS0ksqmAgItmBaKaUVzXLoCSaWUWLhLIacYGoJpRbPUiDYA7V4lkJNMPd8koOWYJwfZYeUYOjNDyXBJP2SDGoBhATTTCXNqMKhI5hoJomGFQwZwVQTSTWuUKgIJptHsoEFQkQw9zTShYZg+C0GBAuHhGDKfinHFgIFwaRzSDq4AAgIpp1C2tH5qS+YeAaJh+elumDqCaQen49UwY1Sd8Ou77a9ljyFcc8feRIFD09M0g8Kj320HQQXJk3wsF/0uGdp1H7R8FuaNMHDju9mL8u4Hd/pC6YfoZu6LZhB9hiE6CRXH3yyuX94YRySxyFGFzVH0SxyxyJIBzXPg1nkjkWQDioK5p46HtQTDL+rUE0w/K5D6nmwd89wS2Fs/LIJ1EJiC95vfXvBQ3BdUg/R++3d8go4pY1PpNdJ7oM7zzM7rhbGKGuMQr1KlUEWp6RxivUaECycGoLhd0VyCHY+++6yMPhdk/UFM/PLLNwLINgDs3AvSBbcmnks60OGzwvjljBu8Z6zegvmljBu8Z6ztmB2+WIX8BmlBNs2I+WeL3ZUX9kAygLBwskgeLdRt0+N5aZK9oIlxr/sM3U3j+3tU+zSFfJIjH/RZ9I3ROu7o9uolQ30kRj/os+kV69owXFLV+gjMf6oFtzYlq6AuqQKHvvg1nNjR1zZ4RRraBILXj6KdsxFp5UdjEQPxQou2e1AMIGCIVh4wRAsvGAIFl5w1qUr0WUvQ6KHYgVnXboSXzaJckUWnHXpSkLZFMoVWfCiqn1LVwA9uE+/Ag8QLJzFgq17KAGSQLBwIFg4ECwcCBYORtHCgWDhQLBwIFg4ECycQoKff3O4stiF36Xn47Qoc3l62eWtgGJzhlsqXk1wgssI3m0Ol471QwC6PCmbFfX8dTYNp8VmDLdUvJrwBBcR3B3v+TCnzU2Ob+68KOdK9OhiM4ZbKt6hsPAElxDcqYfDx3m+15eQbYuZFjEvqs11tJsVmzHcUvG+LktwoT74WP9wZMry9Z0X1XzTd2k5JtVmxWYMt1S8huAElxZseocsvdqsqN1Gr4+yrlSOLTZjuKXiHQsPTTBXwWfV5Cq2mODxpWwdMRnBxQ7R5qX79JvEVjpEm5cyxGuodIhup34m8yBrKPdKUTnOPVYaZJmX8p3bURlklTpNMp8rR1Nb5zQpX7yG4ASXFlxsomP4SFkGLetMdOSL15RddaJjrN/cKN/mm/sbizLlNsr+jL2EYjOGWypeTXCCcbFBOBAsHAgWDgQLB4KFA8HCgWDhQLBwIFg4ECwcCBYOBAsHgoUDwcKBYOFAsHAgWDgQLBwIFg4ECweChQPBwoFg4UCwcCBYOBAsHAgWDgQLB4KFA8HCgeARvUZ+t5G3FzYEj0xPN5cGBE90X/37u5y7DRIBgg80+bYKJQQEH5D54D4Inthv/5Jzv1AqQPBEe/uLxAfKQPDIbvN93i1/iQDBI01/irT0AckcgGDhQLBwIFg4/weGRzBYF527dgAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
</div>
<div id="staircase-discontinuous-fx-lceil-10-x---1-rceil-12" class="section level4">
<h4>Staircase (discontinuous): <span class="math inline">\(f(x) = \lceil
10 x - 1 \rceil + 1/2\)</span></h4>
<p>This function has discontinuities, including one at the location of
the root.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Staircase</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>staircase <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">ceiling</span>(<span class="dv">10</span> <span class="sc">*</span> x <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">itp</span>(staircase, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; function: staircase </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;  7.404e-11         0.5          31</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">uniroot</span>(staircase, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">tol =</span> <span class="fl">1e-10</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; -3.739e-11        -0.5          31</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="warsaw-multiple-roots-fx-ix--1left1-sinleftfrac11xrightright-1" class="section level4">
<h4>Warsaw (multiple roots): <span class="math inline">\(f(x) = I(x &gt;
-1)\left(1 + \sin\left(\frac{1}{1+x}\right)\right)-1\)</span></h4>
<p>This function has multiple roots: we find two of them.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Warsaw</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>warsaw <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">1</span>, <span class="fu">sin</span>(<span class="dv">1</span> <span class="sc">/</span> (x <span class="sc">+</span> <span class="dv">1</span>)), <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># Function increasing over the interval</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">itp</span>(warsaw, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; function: warsaw </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt;    -0.6817  -5.472e-11          11</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="fu">uniroot</span>(warsaw, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">tol =</span> <span class="fl">1e-10</span>)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;    -0.6817  -3.216e-16           9</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co"># Function decreasing over the interval</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="fu">itp</span>(warsaw, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.85</span>, <span class="sc">-</span><span class="fl">0.8</span>))</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; function: warsaw </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt;    -0.8408   6.494e-11           8</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="fu">uniroot</span>(warsaw, <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.85</span>, <span class="sc">-</span><span class="fl">0.8</span>), <span class="at">tol =</span> <span class="fl">1e-10</span>)</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt;    -0.8408  -3.021e-12           6</span></span></code></pre></div>
<pre><code>#&gt; Warning in sin(1/(x + 1)): NaNs produced</code></pre>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In terms of a naive comparison based on the number of iterations
<code>itp</code> and <code>uniroot</code> perform similarly, except in
the repeated-root “Polynomial 3” example, where <code>itp</code>
requires fewer iterations.</p>
</div>
</div>
</div>
<div id="supplying-to-itp-an-external-pointer-to-a-c-function" class="section level2">
<h2>Supplying to <code>itp</code> an external pointer to a C++
function</h2>
<p>The general approach follows the article <a href="https://gallery.rcpp.org/articles/passing-cpp-function-pointers/">Passing
user-supplied C++ functions</a> in the <a href="https://gallery.rcpp.org/">Rcpp Gallery</a>. The user writes a C++
function to calculate <span class="math inline">\(f\)</span>. This
function must have a particular structure. As an example consider the
following function, which implements the Lambert function considered
above.</p>
<pre><code>double lambert_cpp(const double&amp; x, const List&amp; pars) {
  return x * exp(x) - 1.0 ;
}</code></pre>
<p>The function returns a value of double type and has two arguments:
the first is the main argument and is of double type and the second is a
list containing the values of additional parameters whose values are not
specified inside the function. This list must be present, even if an
empty list will be passed to the function. This allows the user to
change the values of any parameters in <span class="math inline">\(f\)</span> without editing the function.</p>
<p>One way to provide C++ functions is to create them in a file, say
<code>user_fns.cpp</code>. Example content is provided below.</p>
<pre><code>#include &lt;Rcpp.h&gt;
using namespace Rcpp;

// [[Rcpp::interfaces(r, cpp)]]

// User-supplied C++ functions for f.
// The only interface is double fun(const double&amp; x, const List&amp; pars).
// The second (List) argument must be included even if the function has no
// additional arguments.
// Each function must be prefaced by the line: // [[Rcpp::export]]

// [[Rcpp::export]]
double lambert_cpp(const double&amp; x, const List&amp; pars) {
  return x * exp(x) - 1.0 ;
}

// [[Rcpp::export]]
SEXP xptr_create(std::string fstr) {
  typedef double (*funcPtr)(const double&amp; x, const List&amp; pars) ;
  if (fstr == &quot;lambert&quot;)
    return(XPtr&lt;funcPtr&gt;(new funcPtr(&amp;lambert_cpp))) ;
  else
    return(XPtr&lt;funcPtr&gt;(R_NilValue)) ;
}</code></pre>
<p>The full file is available on the <a href="https://raw.githubusercontent.com/paulnorthrop/itp/main/src/user_fns.cpp">itp
Github page</a>. The functions in this file are compiled and made
available to R, either using the <code>Rcpp::sourceCpp</code> function
(e.g. <code>Rcpp::sourceCpp(&quot;user_fns.cpp&quot;)</code>) or using RStudio’s
Source button on the editor toolbar. The example content below also
includes the function <code>xptr_create</code>, which creates an
external pointer to a C++ function. It is this external pointer that is
passed to <code>itp</code>. If the user has written a C++ function, say
<code>new_name</code>, then they need to add to <code>xptr_create</code>
(or their own version of this function) two lines of code:</p>
<pre><code>else if (fstr == &quot;new_name&quot;)  
  return(Rcpp::XPtr&lt;funcPtr&gt;(new funcPtr(&amp;new_name))) ;</code></pre>
<p>to create an external pointer for <code>new_name</code> using
<code>create_xptr</code>.</p>
<div id="lambert-fx-x-ex---1-1" class="section level3">
<h3>Lambert: <span class="math inline">\(f(x) = x e^x - 1\)</span></h3>
<p>We repeat the Lambert example, obtaining the same results as above
when we used an R function to supply the function.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Lambert, using an external pointer to a C++ function</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>lambert_ptr <span class="ot">&lt;-</span> <span class="fu">xptr_create</span>(<span class="st">&quot;lambert&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">itp</span>(lambert_ptr, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>res</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; function: lambert_ptr </span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt;     0.5671   2.048e-12           8</span></span></code></pre></div>
</div>
</div>
<div id="c-function-itp_c" class="section level2">
<h2>C++ function <code>itp_c</code></h2>
<p>Also provided is the function <code>itp_c</code>, which is equivalent
to <code>itp</code>, but the calculations are performed entirely using
C++, and the arguments differ slightly: <code>itp_c</code> has a named
required argument <code>pars</code> rather than <code>...</code> and it
does not have the arguments <code>interval</code>, <code>f.a</code> or
<code>f.b</code>. This may be useful if you wish to call an ITP function
on the C++ side.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Calling itp_c()</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">itp_c</span>(lambert_ptr, <span class="at">pars =</span> <span class="fu">list</span>(), <span class="at">a =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>res</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt; function:  </span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt;       root     f(root)  iterations  </span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt;     0.5671   2.048e-12           8</span></span></code></pre></div>
</div>
<div id="plot-method" class="section level2">
<h2>Plot method</h2>
<p>Objects of class <code>itp</code> have a plot method that, by
default, produces a plot of the function over the interval over which
the root was sought and indicates the location of the root using dashed
lines.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">plot</span>(res, <span class="at">main =</span> <span class="st">&quot;Lambert&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">par</span>(oldpar)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEgCAMAAABb4lATAAAAqFBMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6ZpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmOpBmZmZmtttmtv+QOgCQOmaQZgCQZjqQkLaQtpCQttuQ2/+2ZgC2Zjq2ZpC2kGa227a22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb2//b/9vb////tmb/25D/27b//7b//9v///8w3AekAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ8ElEQVR4nO2d62LiNhBGlU2atNsLbLfthl5DL+nS7rYNCfD+b1ZfARtLlq0ZeTT+zo9sUOyRmLOyZBtkcwCqMVM3APACwcqBYOXMRPDGXD34bLc2r967/r7/zflngUBwgx7BL2/d/gUCwQ16BPd1cIHMUfCHt8aYL7LXu6W5/fDaXL07/HVnrvMNMoN/fGPMl4/5dvtfjbn66qnc/ee35lW+X2qKZyh4awqygkxwyeva3LoqyH+v/nr9Pt895+YHCJbKmeD9ynzydHi+M4tC4eLwd2btXe5wUQi+ecxLbove/Fhul/8xK/4Hh2ixtMbgj7+/zh1mgm+eqp+lyXW5XS4yK14Ue2ZOM8H3hwPGYLmcC97/WB6GC8G3h+pnLbgwmG+eFRyP5fXuECyV5iHaXP/0cWkRfFNNqh6qoRqCk+BMcGlyZxN83oPv27tDsFTOBG+L8bSeZF0ILqxWY/Bte3cIlsqmPt6aRWby5ullZRuD86lzPYvOTpBfihlYLdj3eokg5ic4H4Mdk6yL8+BcaS12i/NgoZwJLmbR179sjkfh1hh8upL18uNd9WstOL+2df046TsZykwEzxdSwQZMC7tgymBgMBCsHAhWDgRLgDFJECwBCFYOBCuHMeMQLAHKJBnnS/LqIDg2EKybdr4hWBkQLBG6JF1EgmAJQLByyJJ0GQiCJQDByqFKUkccCFaEr0wITpSYgp0fGQEsdKYaPVgCJEnqDgLBEoBg5ZAMiv7FEBwbgiTZQkCwBCAY9GBNMwSrwJ5lCFYBBMsmNEmO/SFYAhCsnMAkuXaHYAmEJcm5NwRLAIKBHXeGITh1ehIMwakDwQkQkKS+XSFYAuOT1LtnqOB6CTHrUmAQ7IFcwZti/eRDvt7bYmQLQECS+ncME7xfHbVuijV3Q4LNGLGCd8vj6rpby0EaghnxSC56cML45DZ4DK66MMbg+HilNnQWXT+FxtJ/IdiLcUmKIpimFXNnVJL8doJgCYxJkuc+ZII3mEWPZ0SSfHfh6sH48tkQEhTMEwzUeKcVgtMEgnXjn1UIlsDQJA3YPvRa9GkyhVn0eAYmacjmgT14v+p7JhQEeyBXcGb41r0BBHswLEmDtg4eg7en53GGt2auBCsbtjUmWZIhOJxDsGQgWDcUZ1QQHJvA89qh20NwbMIuTA3eAYJjE3RlefgeEBybkHt/I3aB4NgEfDpjzD4QLBOyT25BsEjoPnoJwRIZmUgIlsDYryiM3A2CYzPyO0ZjQ0NwbPqTNDqNECyB3iSNzyIES6AvSQFJhOAUgGDdhOQQguUTlEIIloAzSWEZ5BKML58NwZWkwASiB0vAkaTQ/EGwBOxJCk4fBEvAmqTw7EGwaCBYNwTJg2DBkJzOMMXlCaaV7iSRpA6CJdCZJJrMuQRvq0sV7q8PjqgAtGDsZtbQu6Wpvvm7X9mX+x5XAWjRkSSqvNkE774+d9p8FVwBaHGZJLK0YQyWSQzB+3+5KgB90GXNIXi3LAfh/ffjR2AIHgPlLTj3LPrqIV/zO2CKBcFeGMcr0tCtsvKZOZal3AMqAC2M9QVt6Iuy3HDQWTAEe2EsvxOHvihbG/NuZV+tf3QFoIXp/JU6dLtstyyOzlvnGIwnn1EwkeBvy67rmkXjyWfEkKcr7EIHnptEC8NHFMMuVeLJZ6Rw5CrsZgN6MA3m7CdL6O4yj9uFePIZCeb4gye0R5kNPPmMAnNgS5R1DF7e7948MFUAWhi+PNkFLyA4GoYvTdZD9Kb3aQxN8OSzEPiy5LrQEdKDTYO6AP92/2sY49sF04Ae3A9njiB4cgzjCBwuGDcbQmE8RarD+5RZwM2GUBivcZzie5R1g0uVoTBepDyvoL+sG9xsCMQ0/mGsobesG/TgMCIkJ3gMxs2G0URZoAY3GyYjTmZwHjwVxvI7YzUs1UFwN8b6grEejuoguBPjeMVYEUN1ENxBe3oFwaq4nD1DsCbiZgSCYxM5IRAcmdj5gOC4dKcDY7ASbBcnIVgH1lxAsAYc9xYgOH2ct44gOHkmSwMEx2DCR5NAcASmzAEEs+PRfTEGJ4xPAiA4Xbzef4KCzRGCYOni+fYTFMwTLDG8/3dDcIrIOHhBMBdC3jgE8yCj+x4gmIehejEGJ8Xw3gvBKTHiHUNwOowafCE4FUbOrSA4DcRMnc+AYDIk6oVgMmTqhWAiAvViDBZN+C0zCBYMxbFZsODZr3RH8v7kCp77SndEUyuxgue9TlYSH1cJEzznle5SsHtADx5LInoJxuA5rnRHfmwWOwbPcaU7jpFXsOBRFaQL07wKgmXANvCmIFj9Y3U4T4pSEDykgvRI4pS3EwjuJe3v33AJVvPdpNTfAHqwk0h6MQZPQrzDj1jB9WUOxw3DVAVHHVzECj7sV32PJk1RcPSpg1zBmeHb4RWIZop5oWDBh625d/49KcEKZv1tMMkq0HFK1wUEa+y2Z5AIPrvvHx4sLjLkSh6DcxIVLKfrQjAt4kZcCCZElNkKCCZA8s0P6YKHVhAXwWIjoFnwvM1WqBQMsyd0CU7VLMZgZw3pf3oEglsxGzBUEJt5CzYXEDRLFooFX9rTr/MSRYJnaG9apu7BgBkIVg4ES0DRGAy6gGDlQLBykhYMpoVbcKTYbG3WGBiClQeGYOWBIVh5YAhWHhiClQeGYOWBIVh5YAhWHhhXF5UDwcqBYOVAsHIgWDkQrBwIVg4EKweClQPByoFg5UCwciBYOUyCnz87Li29NebqgSbqeahyffKe9Y2Hh6VsLld7c7wTzCN4tzyuHb7NKt/SpKwR6vlTMg3nYQmby9XeHP8Eswjenhb9L9dNW1P8z22Gsj3iNiwsYXO52lsE808wh+CtWRzfzvNdvoa47VFpg2iG2lAd7RphCZvL1d7DsAQzjcGn+osjE8l/32ao9efZkGZfVXFkWMLmcrW3xDvB3ILL0YFkVGuE2i3zh9yuCTLWCEvYXK72VsF9E5yq4FY1VGHZBFdFZAOxGMFsh+iy6M79lJDBYfkO0WURQXtLJjpEb+pxhniSVcTtCEVx7hFpklUW0Z3bSZlkcZ0mle+LoqvFOU2ia2+Jd4K5BbNd6CjeEsmkJc6FDrr2lrEnvdBR1V8+KW1Dd+2vClXGXWeHbZoRrRGWsLlc7c3xTjBuNigHgpUDwcqBYOVAsHIgWDkQrBwIVg4EKweClQPByoFg5UCwciBYORCsHAhWDgQrB4KVA8HKgWDlQLByIFg5EKwcCFYOBCsHgpUDwcqBYOVAsHIgWDkQXJF/R363pFsGRwoQXJF/U36Tr4SjDAiu2b768w3laoNCgOAja7qlQgUBwUe2hCssyAGCa/ar7yjXC5UCBNdsbv5b6ZtEQ3DNbnlPu+SvECC4Yp2dIpXLEukCgpUDwcqBYOX8D6yFf0j/4AirAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 125, availableFonts: [] }  });
</script>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-OliveiraTakahashi2021" class="csl-entry">
Oliveira, I. F. D., and R. H. C. Takahashi. 2020. <span>“An Enhancement
of the Bisection Method Average Performance Preserving Minmax
Optimality.”</span> <em>ACM Trans. Math. Softw.</em> 47 (1). New York,
NY, USA: Association for Computing Machinery. doi:<a href="https://doi.org/10.1145/3423597">10.1145/3423597</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
